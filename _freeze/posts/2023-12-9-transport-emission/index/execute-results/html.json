{
  "hash": "c29a9120e77084ba51105a5ece55d86d",
  "result": {
    "markdown": "---\ntitle: \"Vehicles emission affects to the climate change\" \ndescription: \"Impact of CAFE standards on reducing carbon dioxide emissions and compare truck and car models relative to these standards.\"\nauthor:\n  - name: Haejin Kim\n    url: https://khj9759.github.io/\n    orcid: 0000-0002-5300-3075\n    affiliation: EDS222 - Statistics for Environmental Data Science\n    affiliation_url: https://ucsb-meds.github.io/\ndate: \"2023-12-15\" \nformat:\n  html:\n    code-fold: true\n    code-summary: \"Code\"\ncategories: [R, Statistics, MEDS] # Corrected spacing in categories\nimage: transport.jpeg\noutput: html_document\n---\n\n\nRepository: <https://github.com/khj9759/transport_emission>\n\n## Import libraries\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(broom)\nlibrary(readr)\nlibrary(gt)\nlibrary(modelr)\nlibrary(lubridate)\nlibrary(xtable)\nlibrary(dplyr)\nlibrary(lubridate)\nlibrary(ggplot2)\nlibrary(tsibble)\nlibrary(sjPlot)\nlibrary(knitr)\nlibrary(here)\nlibrary(ggpubr)\nlibrary(jtools)\n\n\nrm(list = ls())\n\n\nhere::i_am(\"transport_emission.Rmd\")\n\noptions(scipen = 999) # disable scientific notation\n```\n:::\n\n\n## Import Data and Clean up\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# ==============earth surface temperature data===============\ntemperature <- read_csv(\"data/temperature_fig-1.csv\")\ncolnames(temperature) <- c(\"year\", \"temp\", \"temp2\", \"temp3\")\n\n# Remove rows 1 to 6\ntemperature <- temperature[-c(1:6), ]\n\n# Change row 7 to become row 1\nrow_to_move <- temperature[7, ]\ntemperature <- rbind(row_to_move, temperature[-7, ])\n\ntemperature$year <- as.numeric(temperature$year)\ntemperature$temp <- as.numeric(temperature$temp)\n\n# ==========vehicle information including co2 emission each car by year===============\nvehicle_info <- read_csv(\"data/vehicle_info.csv\")\n\nnames(vehicle_info) <- gsub(\" \", \"_\", names(vehicle_info))\nnames(vehicle_info) <- gsub(\"-\", \"_\", names(vehicle_info))\nnames(vehicle_info) <- gsub(\"/\", \"_\", names(vehicle_info))\nnames(vehicle_info) <- gsub(\"[()]\", \"\", names(vehicle_info))\nvehicle_info$Model_Year <- gsub(\"Prelim\\\\.\\\\s*\", \"\", vehicle_info$Model_Year)\nnames(vehicle_info)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"Model_Year\"               \"Regulatory_Class\"        \n [3] \"Vehicle_Type\"             \"Production_Share\"        \n [5] \"Real_World_MPG\"           \"Real_World_MPG_City\"     \n [7] \"Real_World_MPG_Hwy\"       \"Real_World_CO2_g_mi\"     \n [9] \"Real_World_CO2_City_g_mi\" \"Real_World_CO2_Hwy_g_mi\" \n[11] \"Weight_lbs\"               \"Horsepower_HP\"           \n[13] \"Footprint_sq._ft.\"       \n```\n:::\n\n```{.r .cell-code}\n# Function to check if a column can be converted to numeric\nis_numeric <- function(x) {\n  all(!is.na(as.numeric(x)))\n}\n\n# Convert columns with numeric values as characters to numeric type, keep others as character\nvehicle_info <- vehicle_info %>%\n  mutate_if(~is.character(.) && all(sapply(., is_numeric)), as.numeric, na.rm = TRUE)\n\ncolnames(vehicle_info)[colnames(vehicle_info) == \"Model_Year\"] <- \"year\"\n\nvehicle <- left_join(temperature, vehicle_info, by = join_by(year))\n\n# ==========Accumulate emission===============\ncumulative_emissions <- read_csv(\"data/cumulative-co-emissions.csv\")\n\nco2 <- cumulative_emissions %>%\n  filter(Entity == \"United States\") \n\ncolnames(co2) <- c(\"nation\", \"nation1\", \"year\", \"accu_emission\") \n\nemission <- left_join(vehicle, co2, by = join_by(year))\n\n# ==========Accumulate emission===============\ntransport_emission_rate <- read_csv(\"data/emission_percent_transport.csv\")\ncolnames(transport_emission_rate) <- c(\"year\", \"trp_emission_rate\")\n\ntransport_emission <- full_join(emission, transport_emission_rate, by = join_by(year))\n\n## ========== count car ================\ncount_car <- read_csv(\"data/car2.csv\")\n\n# Estimate the number of cars for years ranging from 1900 to 2022 using interpolation\nestimated_cars <- approx(count_car$year, count_car$car, xout = 1900:2022)$y \n\nestimated_cars_data <- data.frame(year = 1900:2022, number_of_car = estimated_cars)\n\nestimate_n_cars <- full_join(transport_emission, estimated_cars_data, by = join_by(year))\n\npercent_emission <- estimate_n_cars %>% \n  mutate(transport_emission = accu_emission*trp_emission_rate*0.01)\n\nfinal <- percent_emission %>%      \n       mutate(emission_n_car = transport_emission/number_of_car) %>% subset(year >= 1975)\n\n## ================ Filter data starting from the year 1975 ===============\nfinal_subset <- final %>%\n  group_by(Regulatory_Class, Vehicle_Type) %>% \n  filter(Regulatory_Class == \"All\", Vehicle_Type == \"All\")\n```\n:::\n\n\n# Vehicles emission affects to the climate change\n\n### Introduction\n\nDuring the industrial revolution, the pervasive utilization of fossil fuels has significantly contributed to the escalation of Carbon dioxide (CO2) emissions, exacerbating the adverse effects of global warming. Various factors have led to the surge in these emissions, with transportation accounting for a substantial one-third share, marking it as the primary contributor to the highest emissions recorded in 2021, as per the Environmental Protection Agency's findings. The objective of this report is to scrutinize the potential of fossil fuels in powering transportation within the United States and to evaluate a proposal by the U.S. government that suggests a partial departure from the standards aimed at curbing fuel consumption, consequently reducing carbon dioxide gas emissions. To mitigate dependence on foreign oil reserves, the United States implemented [Corporate Average Fuel Economy (CAFE)](https://www.nhtsa.gov/laws-regulations/corporate-average-fuel-economy) standards in the 1975, mandating each corporation selling passenger cars in the country to attain improved average emission efficiency.\n\nThese two models signifies the influence of the implementation of CAFE regulations on the reduction of CO2 emissions from vehicles and overall temperature. As these regulations were initiated in 1975, a waiting interval was factored in to enhance accuracy before analyzing the trend, allowing for a comprehensive evaluation of the regulation's effect on CO2 emission trends from number of vehicles.\n\n$$\\text{Ave. Earth surface Temperature} = \\beta_0 + \\beta_1 \\text{emisson from transport} + \\epsilon$$\n\n$$\\text{Emission per car} = \\beta_0 + \\beta_2 \\text{Year since Regulation} + \\beta_3 \\text{Number of Car} + \\epsilon$$\n\n$\\beta_0$ represents the intercept term.\n\n$\\beta_1$ is the coefficients indicating the relationship between motor vehicles CO2 emissions by average annual temperature respectively.\n\n$\\beta_2$ is the coefficients indicating effect of an additional year since CAFE on CO2 emission savings.\n\n$\\beta_3$ is the coefficients indicating the relationship between number of car on the emission per car holding year.\n\n$\\epsilon$ is the error term accounting for unexplained variability in the model.\n\n## Data explore \n\n-   Earth Surface Temperature: This dataset, sourced from the [EPA](https://www.epa.gov/climate-indicators/weather-climate), provides information on the surface temperature, specifically focusing on Ferrnite.\n\n-   Vehicle: Within [EPA](https://www.epa.gov/regulations-emissions-vehicles-and-engines) dataset, various pieces of information are available.\n\n    -   Real_World_CO2_g_mi: This metric represents the emissions per car and is crucial for assessing the efficiency of vehicles in reducing CO2 emissions.\n\n    -   Regulatory_Class: This classification helps determine whether a vehicle is a car or a truck.\n\n-   Accumulative Emission: This data originated from '[Our World in Data](https://ourworldindata.org/grapher/cumulative-co-emissions)'\n\n-   Transportation Emission: This dataset, obtained from the [WorldBank](https://data.worldbank.org/indicator/EN.CO2.TRAN.ZS), sheds light on emissions related to transportation.\n\n-   Number of Vehicles: Unfortunately, there is no dataset available on the current website. However, projections for the years 1900, 1901, 2020, 2021, 2022, and 2023 have been included in this dataset. (**Data availability)**\n\n## Highlights\n\n-   Linear regression\n\n-   Multi-linear regression\n\n-   Interaction model\n\n-   Logit regression\n\n-   Null Hypothesis\n\n## Analysis\n\n### **Linear Regression Model: Earth's Surface Temperature and Emissions from Transport**\n\nThe linear regression model examining the relationship between Earth's surface temperature and emissions from transport is represented as:\n\n$$\\text{Ave. Earth surface Temperature} = \\beta_0 + \\beta_1 \\text{emisson from transport} + \\epsilon$$\n\n#### Plot\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a line plot to visualize the relationship between transportation emissions and Earth surface temperature over the years\n\n# Define the plot using ggplot\ntemp_per_emssion_by_year <- ggplot(final, aes(x = transport_emission, y = temp)) +\n  geom_line() +\n  geom_smooth(linetype = \"dashed\") +\n  labs(x = \"Transportation Emission (CO2e tonne)\", y = \"Earth Surface Temperature (F)\", title = \"Emission per Temperature (from 1975)\") +\n  theme_minimal()\n\n# Display the plot\ntemp_per_emssion_by_year\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 57 rows containing non-finite values (`stat_smooth()`).\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 57 rows containing missing values (`geom_line()`).\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\nThese findings suggest that around 32% of the variability in transportation emissions can be explained by Earth surface temperature. This aligns with our scatter plot, depicting a consistently strong positive relationship. The favorable F-statistics and low p-values further indicate that the model provides a good fit to the data. Due to low $R^2$ , it need to find the better fit.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fit a linear regression model\nmodel <- lm(temp ~ transport_emission, data = final_subset)\n\n# Display a summary of the regression analysis\nsumm(model)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Observations </td>\n   <td style=\"text-align:right;\"> 40 (7 missing obs. deleted) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Dependent variable </td>\n   <td style=\"text-align:right;\"> temp </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Type </td>\n   <td style=\"text-align:right;\"> OLS linear regression </td>\n  </tr>\n</tbody>\n</table> <table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> F(1,38) </td>\n   <td style=\"text-align:right;\"> 17.96 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> R² </td>\n   <td style=\"text-align:right;\"> 0.32 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Adj. R² </td>\n   <td style=\"text-align:right;\"> 0.30 </td>\n  </tr>\n</tbody>\n</table> <table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> Est. </th>\n   <th style=\"text-align:right;\"> S.E. </th>\n   <th style=\"text-align:right;\"> t val. </th>\n   <th style=\"text-align:right;\"> p </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> -1.26 </td>\n   <td style=\"text-align:right;\"> 0.48 </td>\n   <td style=\"text-align:right;\"> -2.65 </td>\n   <td style=\"text-align:right;\"> 0.01 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> transport_emission </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 4.24 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n  </tr>\n</tbody>\n<tfoot><tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> Standard errors: OLS</td></tr></tfoot>\n</table>\n`````\n:::\n:::\n\n\nThis seems to exhibit a slightly better fit, as indicated by the higher \\$R\\^2\\$ and adjusted \\$R\\^2\\$ values. The Earth's temperature increases with the rise in emissions from the transportation sector. Notably, there are significant errors associated with omitted variables, such as emissions from other sectors, including industry and power plants. Additionally, the scope needs to expand beyond the USA to encompass a global perspective.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fit a linear regression model\nmodel_log <- lm(temp ~ log(transport_emission), data = final_subset)\n\n# Display a summary of the regression analysis\nsumm(model_log)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Observations </td>\n   <td style=\"text-align:right;\"> 40 (7 missing obs. deleted) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Dependent variable </td>\n   <td style=\"text-align:right;\"> temp </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Type </td>\n   <td style=\"text-align:right;\"> OLS linear regression </td>\n  </tr>\n</tbody>\n</table> <table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> F(1,38) </td>\n   <td style=\"text-align:right;\"> 19.98 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> R² </td>\n   <td style=\"text-align:right;\"> 0.34 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Adj. R² </td>\n   <td style=\"text-align:right;\"> 0.33 </td>\n  </tr>\n</tbody>\n</table> <table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> Est. </th>\n   <th style=\"text-align:right;\"> S.E. </th>\n   <th style=\"text-align:right;\"> t val. </th>\n   <th style=\"text-align:right;\"> p </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> -48.56 </td>\n   <td style=\"text-align:right;\"> 11.02 </td>\n   <td style=\"text-align:right;\"> -4.41 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> log(transport_emission) </td>\n   <td style=\"text-align:right;\"> 1.96 </td>\n   <td style=\"text-align:right;\"> 0.44 </td>\n   <td style=\"text-align:right;\"> 4.47 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n  </tr>\n</tbody>\n<tfoot><tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> Standard errors: OLS</td></tr></tfoot>\n</table>\n`````\n:::\n:::\n\n\n### **Linear Regression Model: Emission per car and Year since Regulation**\n\nThis model defines the how CAFE regulation effects to the transportation emission. This model explains the vehicle emission effects on CAFE regulation with number of vehicle.\n\n$$\\text{Emission per car} = \\beta_0 + \\beta_2 \\text{Year since Regulation} + \\epsilon$$\n\nIn this plot, emission per car decreasing since regulation started. There was no omitted variable in this model. Based on this information, we would like to how regulation affects on overall transport emission. This model proves that the model shows the interaction between the regulation and number of the car affects on the emission per car. Year since regulation and number of car are independent variables, but it is depended on emission per car variable.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a line plot using ggplot for 'emission_per_car' from the filtered data\none_car_per_emission<- ggplot(final_subset, aes(x = year, y = Real_World_CO2_g_mi)) +\n  geom_jitter() +\n  geom_smooth(linetype = \"dashed\") +\n  labs(x = \"Year\",\n       y = \"Emission Economy (g/mi)\",\n       title = \"emission per car by year\") +\n  theme_minimal()\n\none_car_per_emission\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n### Model without Interaction: Total CO2 emission saving\n\n$$\\text{emission per car} = \\beta_0 + \\beta_2 \\text{year since regulation} + \\beta_3 \\text{number of car} + \\epsilon$$\n\n$\\beta_0$: The predicted emission per car before the regulation is 476 grams per mile (mi/g).\n\n$\\beta_2$: The emissions per car decrease by 5 grams per mile for every year since the regulation, holding the number of cars constant. The coefficient β₂ can be interpreted as the effect of an additional year since the regulation was implemented on emission savings or reduction of emission.\n\n$\\beta_3$: This coefficient represents the estimated change in emission per car for each additional unit in the \"number of car\" variable while holding \"year since regulation\" constant. It implies that as the number of cars increases, overall emission is increasing.\n\n#### Plot\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a scatter plot with a regression line\nggplot(final_subset, aes(x = year, y = Real_World_CO2_g_mi)) +\n  geom_jitter() +  # Scatter plot\n  geom_smooth(method = \"lm\", formula = y ~ x, se = FALSE, color = \"blue\") +  # Regression line\n  labs(x = \"Year Since Regulation\", y = \"Emission Economy (g/mi)\", title = \"Regression Plot\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nIn this analysis, p-value is 9.1e-9, which is \\< 0.05 can reject null hypothesis. R square is pretty low, which is 0.5.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Convert 'year' to (year - 1974): Year in 1975 becomes 1.\nfinal_subset$years <- final_subset$year - 1974\n\n## Fit a linear model without interaction\nmodel_not_int <- lm(Real_World_CO2_g_mi ~ years + number_of_car, data = final_subset)\nsumm(model_not_int, digits = 10)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Observations </td>\n   <td style=\"text-align:right;\"> 47 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Dependent variable </td>\n   <td style=\"text-align:right;\"> Real_World_CO2_g_mi </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Type </td>\n   <td style=\"text-align:right;\"> OLS linear regression </td>\n  </tr>\n</tbody>\n</table> <table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> F(2,44) </td>\n   <td style=\"text-align:right;\"> 23.9688718881 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> R² </td>\n   <td style=\"text-align:right;\"> 0.5214152731 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Adj. R² </td>\n   <td style=\"text-align:right;\"> 0.4996614218 </td>\n  </tr>\n</tbody>\n</table> <table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> Est. </th>\n   <th style=\"text-align:right;\"> S.E. </th>\n   <th style=\"text-align:right;\"> t val. </th>\n   <th style=\"text-align:right;\"> p </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 476.2446425522 </td>\n   <td style=\"text-align:right;\"> 111.8001104335 </td>\n   <td style=\"text-align:right;\"> 4.2597868706 </td>\n   <td style=\"text-align:right;\"> 0.0001060282 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> years </td>\n   <td style=\"text-align:right;\"> -5.1880489159 </td>\n   <td style=\"text-align:right;\"> 3.8176342030 </td>\n   <td style=\"text-align:right;\"> -1.3589696236 </td>\n   <td style=\"text-align:right;\"> 0.1810818273 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> number_of_car </td>\n   <td style=\"text-align:right;\"> 0.0000000533 </td>\n   <td style=\"text-align:right;\"> 0.0000001314 </td>\n   <td style=\"text-align:right;\"> 0.4057541837 </td>\n   <td style=\"text-align:right;\"> 0.6868896864 </td>\n  </tr>\n</tbody>\n<tfoot><tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> Standard errors: OLS</td></tr></tfoot>\n</table>\n`````\n:::\n:::\n\n\n### Interaction model: Total CO2 emission saving\n\n$$\\text{emission per car} = \\beta_0 + \\beta_2 \\text{year since regulation} + \\beta_3 \\text{number of car} +\\beta_4 \\text{year since regulation x number of car} + \\epsilon$$\n\n$\\beta_4$: This is interaction term implies the influence of the number of car on emission per car slightly changes as the year since regulation starts and it is defined the barometer of total CO2 emission saving.\n\nDecreasing the p-value compared to two models suggests that the interaction model between the year since regulation and the number of cars rejects the notion that their combined effect has no impact on understanding variations in CO2 emissions per car. Additionally, the higher $R^2$ and adjusted $R^2$ values signify that this interaction model better fits the data and captures a greater proportion of the variability in emissions compared to the model without the interaction term.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Fit a linear model with interaction\nmodel_int <- lm(Real_World_CO2_g_mi ~ years + number_of_car + years:number_of_car, data = final_subset)\n\nsumm(model_int, digits = 10)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Observations </td>\n   <td style=\"text-align:right;\"> 47 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Dependent variable </td>\n   <td style=\"text-align:right;\"> Real_World_CO2_g_mi </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Type </td>\n   <td style=\"text-align:right;\"> OLS linear regression </td>\n  </tr>\n</tbody>\n</table> <table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> F(3,43) </td>\n   <td style=\"text-align:right;\"> 24.5633246590 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> R² </td>\n   <td style=\"text-align:right;\"> 0.6315021888 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Adj. R² </td>\n   <td style=\"text-align:right;\"> 0.6057930392 </td>\n  </tr>\n</tbody>\n</table> <table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> Est. </th>\n   <th style=\"text-align:right;\"> S.E. </th>\n   <th style=\"text-align:right;\"> t val. </th>\n   <th style=\"text-align:right;\"> p </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 378.7346753916 </td>\n   <td style=\"text-align:right;\"> 102.8984504157 </td>\n   <td style=\"text-align:right;\"> 3.6806645179 </td>\n   <td style=\"text-align:right;\"> 0.0006442009 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> years </td>\n   <td style=\"text-align:right;\"> -25.7574887204 </td>\n   <td style=\"text-align:right;\"> 6.6647727476 </td>\n   <td style=\"text-align:right;\"> -3.8647212284 </td>\n   <td style=\"text-align:right;\"> 0.0003704727 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> number_of_car </td>\n   <td style=\"text-align:right;\"> 0.0000002524 </td>\n   <td style=\"text-align:right;\"> 0.0000001292 </td>\n   <td style=\"text-align:right;\"> 1.9534542357 </td>\n   <td style=\"text-align:right;\"> 0.0572918953 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> years:number_of_car </td>\n   <td style=\"text-align:right;\"> 0.0000000068 </td>\n   <td style=\"text-align:right;\"> 0.0000000019 </td>\n   <td style=\"text-align:right;\"> 3.5841371809 </td>\n   <td style=\"text-align:right;\"> 0.0008572249 </td>\n  </tr>\n</tbody>\n<tfoot><tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> Standard errors: OLS</td></tr></tfoot>\n</table>\n`````\n:::\n:::\n\n\n### Logit regression using Categorical response variable: New and Old Vehicle\n\nWe will further study the new vehicles have effectively reducing emission. This is the showing two plots, which old vehicle before 2000 year model, and new vehicle after 2000 year model with the linear line.\n\n$$\\operatorname{logit}(p)=\\log \\left(\\frac{p}{1-p}\\right)=\\beta_0 + \\beta_1 \\times \\text{car per emission} + \\beta_2 \\times \\text{Model} + \\varepsilon $$\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a new variable 'new_brand' based on the year\n# Filter the dataset to include only \"Car\" and \"Truck\" in Regulatory_Class\nfinal_vehicle_type <- final %>% \n  mutate(new_brand = ifelse(year > 2000, 'new', 'old')) %>%\n  filter(Regulatory_Class %in% c(\"Car\", \"Truck\"))\n\n# Create a jitter plot to show CO2 emissions and new/old classification\nggplot(data = final_vehicle_type, aes(y = new_brand, x = Real_World_CO2_g_mi)) + \n  geom_jitter(width = 0, height = 0.05, alpha = 0.8) +\n  labs(x = \"CO2 Emission per Car\", y = \"Brand New\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\nThis involves showcasing two plots: one for older vehicles predating the year 2000 model and another for newer vehicles following the 2000 model year, each presented with a linear trend line.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a binary variable 'brand_new' based on 'new_brand'\nfinal_vehicle_type <- final_vehicle_type %>%\n  mutate(brand_new = ifelse(new_brand == \"new\", 1, 0))\n\n# Create a jitter plot to visualize CO2 emissions and brand new classification\nbinary <- ggplot(data = final_vehicle_type, aes(y = brand_new, x = Real_World_CO2_g_mi)) + \n  geom_jitter(width = 0, height = 0.05, alpha = 0.8) +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  labs(x = \"CO2 Emission per Car\", y = \"Brand New\") \nbinary\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\nThe odds ratio of 0.99 indicates that for each one-unit increase in the 'emission per car' there is an approximate 1% reduction in emissions for newer vehicle models compared to older ones, tending to exhibit approximately 1% lower emissions concerning their CO2 levels compared to older models. This association highlights the potential for newer vehicle models to contribute slightly less to CO2 emissions in real-world scenarios compared to their older counterparts.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a logistic regression model for predicting 'brand_new'\nmod_new_car <- glm(brand_new ~ Real_World_CO2_g_mi, data = final_vehicle_type, family = 'binomial') \n\n# Create a table summarizing the logistic regression model\nmod_new_car %>% tab_model()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">brand new</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Odds Ratios</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">260.62</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">61.89&nbsp;&ndash;&nbsp;1258.49</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Real World CO2 g mi</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.99</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.98&nbsp;&ndash;&nbsp;0.99</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">329</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">R<sup>2</sup> Tjur</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.227</td>\n</tr>\n\n</table>\n\n`````\n:::\n:::\n\n\n### Visualizing logistic regression\n\nThis is combining two models: linear regression model and logistic regression model, proving insight into both linear and non-linear relationships between old and new vehicles variables.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a binary plot with linear and logistic regression lines\nggplot(data = final_vehicle_type, aes(y = brand_new, x = Real_World_CO2_g_mi)) +\n  geom_jitter(width = 0, height = 0.05, alpha = 0.8) +\n  labs(x = \"CO2 Emission per Car\", y = \"Brand New\") +\n  geom_smooth(method = \"lm\", se = FALSE) +  # Add linear regression line\n  geom_smooth(method = \"glm\", se = FALSE, color = \"red\", \n              method.args = list(family = \"binomial\"))  # Add logistic regression line in red\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n### Logistic regression: Truck and Car\n\nIn the context of environmental impact and vehicle emissions, there's a growing concern about the differences in CO2 emissions per mile between different types of vehicles. To evaluate and address these concerns, a statistical analysis is conducted to compare the mean CO2 emissions per mile between two categories of vehicles: cars and trucks. This analysis aims to determine whether there's a significant difference in CO2 emissions per mile between these vehicle types.\n\n$$\\operatorname{logit}(p)=\\log \\left(\\frac{p}{1-p}\\right)=\\beta_0 + \\beta_1 \\times \\text{car per emission} + \\beta_2 \\times \\text{Truck} + \\varepsilon $$\n\nThe coefficient related to 'Regulatory_ClassTruck' in the logistic regression model indicates an interesting finding. It suggests that the odds of a brand new car reducing its emissions are approximately 22 times higher compared to trucks. This translates to an approximate decrease of emissions by 2.8% in a new truck model compared to older models. This suggests that trucks have not significantly improved their efficiency over the span of nearly 50 years.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fit the logistic regression model\nmod <- glm(brand_new ~ Real_World_CO2_g_mi + Regulatory_Class, \n           data = final_vehicle_type, family = binomial)\n\n# Extract coefficients, exponentiate, and tidy the results\nexp(coef(mod)) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          (Intercept)   Real_World_CO2_g_mi Regulatory_ClassTruck \n        39449.4440170             0.9728793            22.0806972 \n```\n:::\n:::\n\n\n#### Histogram\n\nThis diagram clearly shows that the distribution of vehicle emissions is highly right-skewed compared to trucks. This indicates that the Environmental Protection Agency (EPA) has successfully regulated car emissions. However, there is a need for more effort to reduce emissions from trucks.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngghistogram(final_vehicle_type, x = \"Real_World_CO2_g_mi\",\n   add = \"mean\", rug = TRUE,\n   color = \"Regulatory_Class\", fill = \"Regulatory_Class\",\n   palette = c(\"#00AFBB\", \"#E7B800\")) + \n  labs(title = \"Comparison of CO2 Emissions between Car and Truck Groups\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\nThis finding aligns with EPA's [Clean Truck Plan](https://www.epa.gov/regulations-emissions-vehicles-and-engines/clean-trucks-plan), unveiled on August 5, 2021. The plan aims to curb CO2 gas emissions and other harmful air pollutants from heavy-duty trucks. It outlines a series of three rulemakings that will come into effect for heavy-duty engines and vehicles starting from the model year 2027.\n\n### Hypothesis to comparing two models: Car and Truck\n\n$$H_{0}: \\mu_{car} - \\mu_{Truck} = 0$$\n\n$$H_{A}: \\mu_{car} - \\mu_{Truck} \\neq 0$$\n\nThe p-value of 2.22e-14 is less than any commonly used significance level (such as 0.05), indicating strong evidence to reject the null hypothesis. Therefore, there is strong evidence to suggest that there is a significant difference in CO2 emissions per mile between the car and truck.\n\nThere is a 95% confidence that the range between 84.8 and 127.7 includes the true difference in CO2 emissions per mile between cars and trucks.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# in Regulatory_Class, \"All\", \"Car\", and \"Truck\", so only left \"Car\" and \"Truck\" in dataset. \nfinal_class <- final %>% filter(Regulatory_Class %in% c(\"Car\", \"Truck\"))\n\n# Separate data into 'Car' and 'Truck' groups\ncar <- final_class %>% filter(Regulatory_Class == \"Car\")\ntruck <- final_class %>% filter(Regulatory_Class == \"Truck\")\n\n# Conduct a t-test to compare CO2 emissions between 'Car' and 'Truck' groups\nt_test_result <- t.test(truck$Real_World_CO2_g_mi, car$Real_World_CO2_g_mi, conf.level = 0.95)\n# Uncomment the next line to display the summary statistics using tab_model\nt_test_result\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWelch Two Sample t-test\n\ndata:  truck$Real_World_CO2_g_mi and car$Real_World_CO2_g_mi\nt = 9.7546, df = 283.31, p-value < 0.00000000000000022\nalternative hypothesis: true difference in means is not equal to 0\n95 percent confidence interval:\n  84.81797 127.70204\nsample estimates:\nmean of x mean of y \n  520.268   414.008 \n```\n:::\n:::\n\n\n## Conclusion\n\nThe analysis highlights the impact of Earth's surface temperature and regulatory standards, like Corporate Average Fuel Economy (CAFE), on reducing emissions per car. Logistic regression underscores the lower emissions of newer vehicles, emphasizing the need for ongoing technological advancements. The significant disparity in emissions between cars and trucks calls for targeted efforts to enhance truck efficiency.\n\n### Future work\n\nFuture endeavors should focus on a global perspective, assess policy effectiveness, explore technological advancements for emissions reduction, and monitor long-term trends. Continuous policy evaluation is crucial, considering initiatives like the Clean Truck Plan, while strengthening public awareness and advocacy efforts will foster sustainable practices in transportation.\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}